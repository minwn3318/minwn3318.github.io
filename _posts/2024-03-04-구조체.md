---
layout: post
title: 구조체
subtitle: 구조체에 대해 알아보자
categories: [c++]
tags: [c++, 문서, 구조체]
---
   
## 구조체란 무엇일까?   

**구조체란** 기존의 자료형들의 모음으로 개발자 사용자가 정의한 커스텀자료형이다   

## 구조체는 왜 사용하는 걸까?   

어떤 학교에서 사람을 이름, 학년, 학과로 데이터베이스를 만든다고 하자(이때 데이터베이스 언어 같은 것은 잠시 접어두고 구조체로 표현한다 가정하자) 그러면 각각 자료형을 정할거다.    

문제는 해당 자료를 어떻게 정리하고 분류하지라는 거다. 사람으로 모으고 싶은데 이름 배열 따로, 학년 배열 따로, 학과 배열 따로는 너무 비효율적이다.   

이러한 문제가 일어나는 것은 지금 개발자가 **객체**관점으로 프로그래밍을 하려하기 때문이다. 하지만 프로그래밍 언어는 그렇지 않았다.   

따라서 **객체적으로 자료를 분류하고 정렬하기 위해 구조체를 사용하게 되었다.**   

## 구조체는 어떻게 사용할까?   

* 정의 : **블록 앞에 struct 이름을 붙이고 블록 끝에 ;을 붙여주면 된다.** 안의 변수들은 자유롭게 원하는대로 넣으면 된다
  
```
struct 이름{

~~~~

};
```

* 선언 : 변수 선언시 자료형을 적어주어야 하는데 구조체 같은 경우 자료형 이름이 **struct 이름**이므로 이것을 통째로 붙인 뒤, 변수명을 붙여주어야 한다.
   
* 변수 할당은 대괄호를 사용하여 안에 있는 자료형 변수 순서에 맞게 데이터를 대입해주면 된다. 
  
```
struct 이름 변수명 = {0,0,0};
```

* 값 수정 : 값을 수정하고 싶으면 **변수명.해당변수**를 하여 값을 대입해주면 된다

```
변수명.해당변수 = 0;
```

* 배열할당 : 배열할당은 정말 단순하게 문자열이나 정수열을 할당하는 것처럼 **변수명[]0**을 해주면 된다. 단 앞에 **struct 이름**이 존재해야한다
   
* 인덱싱도 마찬가지로 [] 연산자를 사용하면 된다.

```
struct 이름 변수명[n] = {};
변수명[0];
```

* 포인터 변수 : 다른 기본 자료형들이 포인터 변수를 가지는 것처럼 표시하면 된다

* 포인터 변수로 선언된 구조체에서 값을 변경하려면 . 이아닌 ->을 사용하여야 한다
  
```
struct 이름 변수1;
struct 이름 * 변수 = &변수1;

변수->해당자료형 = ;
```

### 구조체와 메모리구조   

구조체와 같은 객체를 선언하게 되면 발생하는 것중에 하나가 바로 메모리 할당 구조다.    

구조체에는 기본 자료형들이 들어간다. 이 기본 자료형들은 각각 용량을 가지게 된다.    
   
그리고 구조체는 그 용량들의 합만큼 메모리 공간을 차지하게 된다.   

그러나 다음과 같은 문제가 발생하게 된다

```
#include <iostream>
using namespace std;

typedef struct { //16
    int a,b;
    long long c;
} STRUCT_A;

typedef struct{ //24
    int b;
    STRUCT_A a;
} STRUCT_B;

int main(void)
{
    STRUCT_B b;
    STRUCT_A a;
    
    int size1 = sizeof(a);
    int size2 = sizeof(b);

    cout << size1 << " " << size2 << endl;

    return 0;
}

//16 24
```

해당 코드를 실행하면 b구조체는 20이 아닌 24를 가지게 된다.   

#### 워드에 의한 메모리 할당 처리   

이러한 사태가 일어나는 이유는 컴퓨터 시스템이 한 번에 데이터를 처리하는 단위인 **워드** 때문이다   

워드는 보통 **32비트 체계에서는 4바이트**, **64바이트 체계에서는 8바이트**를 가진다.   

컴퓨터는 이 워드단위로 데이터를 처리하기에 기본 자료형들을 이 **워드 크기의 약수 혹은 배수** 크기를 가지게 된다.   

그리고 컴퓨터는 구조체에 있는 자료형 중 가장 큰 기본자료형 크기를 단위로 처리하게 된다.     

a 구조체 같은 경우 8바이트인 long long을 단위로 하여 메모리를 할당한다   

b 같은 경우 a 구조체를 바탕으로 할 것 같지만, 컴퓨터는 **자신에게 미리 정의된 기본 자료형을 바탕**으로 메모리 크기를 정한다   

따라서 b의 기준이 되는 자료형은 a가 아니라 a를 이루는 long long이 된다.   
